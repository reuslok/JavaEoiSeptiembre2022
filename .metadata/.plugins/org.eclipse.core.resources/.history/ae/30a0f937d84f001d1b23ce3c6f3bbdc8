package es.eoi.app;

import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import es.eoi.config.BBDDUtils;

public class MantenimientoEmpleados {

	public static void main(String[] args) {

		try {

			String dniEmpleado = null;

			Connection conexion = BBDDUtils.openConnection();

			System.out.println("Conectado:"+BBDDUtils.BBDD_URL);

			Statement instruccionSQL = conexion.createStatement();

			String sql = " SELECT EMPLEADO.NOMBRE, DEPARTAMENTO.NOMBRE AS DEPARTAMENTO "

					+ " FROM EMPLEADO "

					+ " INNER JOIN DEPARTAMENTO ON EMPLEADO.CODIGO_DEPARTAMENTO = DEPARTAMENTO.CODIGO ";

			if (dniEmpleado != null) {

				sql = sql + " WHERE EMPLEADO.DNI = ?";
			}
			
			ResultSet resultadoConsulta = instruccionSQL.executeQuery(sql);
			while(resultadoConsulta.next()) {
				System.out.println(
					resultadoConsulta.getString("NOMBRE") + " ("+
					resultadoConsulta.getString("DEPARTAMENTO")+")");
			}
			
			conexion.close();
			
		} catch (SQLException e) {

			System.out.println("Error al abrir conexi√≥n a BBDD.");

			e.printStackTrace();

		}
	}
}

